<%= semantic_form_for [:admin, @order_admin_form], url: { action: 'update' } do |f| %>
  <%= f.semantic_errors %>

  <%= f.inputs "Sender Info" do %>
    <%= f.fields_for :sender, @order_admin_form.sender do |builder|%>
      <%= builder.input :name, required:true, placeholder: '您的姓名' %>
      <%= builder.input :email, required:true, placeholder: '以便及时收到订单更新'  %>
      <%= builder.input :phone, required:true, placeholder: '以便我们和您核对信息'  %>
    <% end %>
  <% end %>

  <!-- FIXME use helper methods to prepare the collection hash -->
  <%= f.inputs "Delivery Info" do %>
    <%= f.fields_for :address, @order_admin_form.address do |builder| %>
      <%= builder.input :province_id, prompt: "请选择", collection: @collection_data[:provinces] %>
      <%= builder.input :city_id, prompt: "请选择", collection: @collection_data[:cities] %>
      <%= builder.input :area_id, prompt: "请选择", collection: @collection_data[:areas] %>
      <%= builder.input :address %>
      <%= f.input :bypass_region_validation, as: :boolean %>
      <%= builder.input :post_code %>
      <%= builder.input :fullname %>
      <%= builder.input :phone %>
      <%= f.input :expected_date, as: :string, required: true, input_html: { class: 'datepicker' }%>
      <%= f.input :bypass_date_validation, as: :boolean %>
    <% end %>
  <% end %>

  <%= f.inputs "Check Info" do %>
    <%= f.input :delivery_date, as: :string, input_html: { class: 'datepicker' }%>
    <%= f.input :ship_method_id, as: :radio, collection: ShipMethod.all %>
  <% end %>
  <%= f.actions %>

  <%= f.inputs "Payment Info" do %>
    <%= f.input :adjustment,
      placeholder: '+20.0, -30.0, x1.1, *0.9 etc.',
      hint: 'support multiple calculation(+,-,*,x,%,/), validate format includes "-20.0", "x1.1", "%2" etc.' %>
    <%= f.input :coupon_code %>
  <% end %>

  <%= f.inputs "Order Info" do %>
    <%= f.input :source, as: :radio, collection: ["微博", "人人", "豆瓣", "Facebook", "微信", "杂志等平面媒体", "搜索引擎", "朋友推荐", "网络广告", "视频网站", "淘宝", "电视", "其他"] %>
    <%= f.input :special_instructions, as: :text %>
    <%= f.input :gift_card_text, as: :text %>
  <% end %>

  <%= f.inputs "Line Items" do %>
    <% @order_admin_form.line_items.each do |item| %>
      <%= f.fields_for :line_items, item do |builder| %>
        <%= builder.input :product_id, include_blank: false, collection: @collection_data[:line_items], input_html: { class: 'chosen' } %>
        <%= builder.input :quantity %>
        <%= link_to "Remove Product", "#", class: "remove_fields" %>
      <% end %>
    <% end %>
    <li class="input">
      <label class="label"><%= t('views.admin.order.add_product') %></label>
      <%= link_to_add_line_items t('views.admin.order.add_product'), f, :line_items %>
    </li>
    <%= f.input :bypass_product_validation, as: :boolean %>
  <% end %>

  <%= f.actions %>
<% end %>
